$(document).ready(function(){function h(a){var b=a.getFullYear().toString(),g=(a.getMonth()+1).toString();a=a.getDate().toString();1==a.length&&(a="0"+a);1==g.length&&(g="0"+g);return b+"-"+g+"-"+a}function e(a){$.ajax({type:"GET",url:"https://api.nasa.gov/planetary/apod?api_key=TFtUNCGWFpQCN7pAdwvgLARTk2ENUR2M17kuRm3w&date="+a,headers:{Accept:"application/json"}}).done(function(b){var a="";b.date&&(a=b.date.split("-"),a=(new Date(Date.UTC(a[0],a[1]-1,a[2]))).toLocaleDateString(void 0,{year:"numeric",
month:"long",day:"numeric",timeZone:"UTC"}));var c="";b.copyright&&(c="Copyright: "+b.copyright);b.url&&"image"==b.media_type&&$("#apod").html("<small>"+a+"</small><h2>"+b.title+'</h2><img class="img-thumbnail img-responsive" src="'+b.url+'" alt="'+b.title+'" /><small>'+c+"</small>");if(b.url&&"video"==b.media_type){var d="",e="";f&&(d="800",e="450");$("#apod").html("<small>"+a+"</small><h2>"+b.title+'</h2><iframe class="img-thumbnail img-responsive" src="'+b.url+'" lt="'+b.title+'" width="'+d+'" height="'+
e+'" frameborder="0" allow="encrypted-media"></iframe><small>'+c+'</small><button class="btn btn-link" id="videoModal"> Open larger view</button>')}f&&($("#videoModal").remove(),$("#apod img, #apod iframe").removeClass("img-thumbnail"),b.explanation&&$("#apod").append('<p class="explanation">'+b.explanation+"</p>"))}).fail(function(){console.log("Oh noes! Error getting photo");$("#apod").html('<h2>Sorry, something went wrong getting the NASA picture of the day! Plese enjoy this photo of Camilla the space chicken instead.</h2><img id="apodThumb" class="img-responsive" src="Space_chicken.jpg" alt="Camilla the space chicken" /><small><a href="https://commons.wikimedia.org/wiki/File:Space_chicken.jpg">Space Chicken</a> by <a href="https://commons.wikimedia.org/wiki/User:BCampbell_(WMF)">BCampbell (WMF)</a> is licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.en">CC BY SA 4.0</a></small>')})}
var f=!1;0<window.location.pathname.indexOf("modal")&&(f=!0);var c;if(f){var d=new URLSearchParams(window.location.search);d.has("requestedDate")&&(c=d.get("requestedDate"))}else c=h(new Date);e(c);d=0<$("form").length?$("form").parent():"body";$('input[name="requestedDate"]').datepicker({format:"yyyy-mm-dd",container:d,todayHighlight:!0,autoclose:!0,clearBtn:!0});$("#dateSubmit").click(function(a){c=$('input[name="requestedDate"]').val();e(c)});$("#apod, #videoModal").click(function(a){a.preventDefault();
f||client.invoke("instances.create",{location:"modal",url:"assets/modal.html?requestedDate="+c,size:{width:"800px",height:"1000px"}}).then(function(a){client.instance(a["instances.create"][0].instanceGuid).on("modal.close",function(){})})})});